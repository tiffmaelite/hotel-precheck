\hypertarget{SH__SqlDataModel_8cpp}{\section{S\-H\-\_\-\-Sql\-Data\-Model.\-cpp}
\label{SH__SqlDataModel_8cpp}\index{/home/tiff/\-Stage-\/\-I\-U\-T/app/simplhotel/hotel-\/precheck/src/\-Pre\-Check/models/\-S\-H\-\_\-\-Sql\-Data\-Model.\-cpp@{/home/tiff/\-Stage-\/\-I\-U\-T/app/simplhotel/hotel-\/precheck/src/\-Pre\-Check/models/\-S\-H\-\_\-\-Sql\-Data\-Model.\-cpp}}
}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include <QDir>}
00002 \textcolor{preprocessor}{#include <QDebug>}
00003 \textcolor{preprocessor}{#include "\hyperlink{SH__MessageManager_8h}{SH\_MessageManager.h}"}
00004 \textcolor{preprocessor}{#include <QtSql/QSqlDriver>}
00005 \textcolor{preprocessor}{#include <QtCore>}
00006 \textcolor{preprocessor}{#include "\hyperlink{SH__SqlDataModel_8h}{SH\_SqlDataModel.h}"}
00007 \textcolor{preprocessor}{#include "\hyperlink{SH__DatabaseManager_8h}{SH\_DatabaseManager.h}"}
00008 \textcolor{comment}{/*namespace SimplHotel}
00009 \textcolor{comment}{\{*/}
\hypertarget{SH__SqlDataModel_8cpp_source_l00014}{}\hyperlink{classSH__SqlDataModel_a946716dc9b74e3ec4a70778319ceb3f8}{00014} \hyperlink{classSH__SqlDataModel_a946716dc9b74e3ec4a70778319ceb3f8}{SH\_SqlDataModel::SH\_SqlDataModel}(\hyperlink{classQObject}{QObject} *parent) :
00015     \hyperlink{classQAbstractListModel}{QAbstractListModel}(parent)
00016 \{
00017 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00022}{}\hyperlink{classSH__SqlDataModel_a48d361600552aa4f80af693a68fc41dd}{00022} \textcolor{keywordtype}{int} \hyperlink{classSH__SqlDataModel_a48d361600552aa4f80af693a68fc41dd}{SH\_SqlDataModel::rowCount}(\textcolor{keyword}{const} QModelIndex &parent)\textcolor{keyword}{ const}
00023 \textcolor{keyword}{}\{
00024     Q\_UNUSED(parent);
00025     \textcolor{keywordflow}{return} \hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.count();
00026 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00031}{}\hyperlink{classSH__SqlDataModel_aa4664329d52c2d2cba2bacc42fa1a564}{00031} QVariant \hyperlink{classSH__SqlDataModel_aa4664329d52c2d2cba2bacc42fa1a564}{SH\_SqlDataModel::data}(\textcolor{keyword}{const} QModelIndex &index, \textcolor{keywordtype}{int} role)\textcolor{keyword}{ const}
00032 \textcolor{keyword}{}\{
00033     \textcolor{keywordflow}{if} (this->\hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.count() > 0)
00034     \{
00035         \textcolor{keywordtype}{int} row = index.row();
00036         \textcolor{keywordtype}{int} column = this->\hyperlink{classSH__SqlDataModel_a3c6539114dd06aa8043e7a4e9762f6f4}{fieldFromRole}(role);
00037         \textcolor{keywordtype}{int} nbCols = this->\hyperlink{classSH__SqlDataModel_ad1e46c72a6aeb83e3e7bb0c3110d12a4}{mRoles}.count();
00038         \textcolor{keywordflow}{if}(column >= 0 && column < nbCols) \{
00039             \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(QString(\textcolor{stringliteral}{"row : %1, column : %2,
       field: %3 (%4), value : %5\(\backslash\)n"}).arg(index.row()).arg(index.column()).arg(column).arg(QString(this->
      \hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.at(column)->role())).arg(this->\hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.at(row).value(column).toString()));
00040             \textcolor{keywordflow}{return} this->\hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.at(row).value(column);
00041         \} \textcolor{keywordflow}{else}\{
00042             \hyperlink{classSH__MessageManager_a0cb4f06cf67539457482ba1c8544eb06}{SH\_MessageManager::errorMessage}(QString(\textcolor{stringliteral}{"rien à retourner pour
       %1x%2x%3 (%4>=%5)"}).arg(index.row()).arg(index.column()).arg(role).arg(column).arg(nbCols));
00043         \}
00044     \}
00045     \hyperlink{classSH__MessageManager_a0cb4f06cf67539457482ba1c8544eb06}{SH\_MessageManager::errorMessage}(\textcolor{stringliteral}{"modèle vide"});
00046     \textcolor{keywordflow}{return} QVariant();
00047 \}
00048 
\hypertarget{SH__SqlDataModel_8cpp_source_l00053}{}\hyperlink{classSH__SqlDataModel_a24db284b370930b57e2261a7a72e2da8}{00053} QVariantMap \hyperlink{classSH__SqlDataModel_a24db284b370930b57e2261a7a72e2da8}{SH\_SqlDataModel::datas}()\textcolor{keyword}{ const}
00054 \textcolor{keyword}{}\{
00055     \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(\textcolor{stringliteral}{"datas"});
00056     QVariantMap result;
00057     \textcolor{keywordflow}{if} (this->\hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.count() > 0)
00058     \{
00059         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} column = 0; column < this->\hyperlink{classSH__SqlDataModel_ad1e46c72a6aeb83e3e7bb0c3110d12a4}{mRoles}.count(); column++) \{
00060             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} row = 0; row < this->\hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.count();row++) \{
00061                 \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}( \textcolor{stringliteral}{"data inserted"});
00062                 result.insertMulti(this->\hyperlink{classSH__SqlDataModel_ad1e46c72a6aeb83e3e7bb0c3110d12a4}{mRoles}.value(column),this->
      \hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.at(row).value(column));
00063             \}
00064         \}
00065     \}
00066     \textcolor{keywordflow}{return} result;
00067 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00072}{}\hyperlink{classSH__SqlDataModel_aae31b72ec89a35a7b8d4175d7bcaa33a}{00072} \textcolor{keywordtype}{bool} \hyperlink{classSH__SqlDataModel_aae31b72ec89a35a7b8d4175d7bcaa33a}{SH\_SqlDataModel::setHeaderData}(\textcolor{keywordtype}{int} section, Qt::Orientation orientation,
       \textcolor{keyword}{const} QVariant &value, \textcolor{keywordtype}{int} role)
00073 \{
00074     Q\_UNUSED(role);
00075     \textcolor{keywordflow}{if} (orientation == Qt::Horizontal)
00076     \{
00077         this->\hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.at(section)->setText(value.toString());
00078         \textcolor{keywordflow}{return} (this->\hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.at(section)->text() == value.toString());
00079     \}
00080     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
00081 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00086}{}\hyperlink{classSH__SqlDataModel_aee909d0a29715d02d920fcf854bfbba2}{00086} \textcolor{keyword}{const} QString \hyperlink{classSH__SqlDataModel_aee909d0a29715d02d920fcf854bfbba2}{SH\_SqlDataModel::query}()\textcolor{keyword}{ const}
00087 \textcolor{keyword}{}\{
00088     \textcolor{keywordflow}{return} \hyperlink{classSH__SqlDataModel_a54f0cf057e3200f6b199508958e43fec}{mSqlQuery}.lastQuery();
00089 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00094}{}\hyperlink{classSH__SqlDataModel_afced07f7b9e6fecd349a5428a1a4615e}{00094} \textcolor{keyword}{const} QString &\hyperlink{classSH__SqlDataModel_afced07f7b9e6fecd349a5428a1a4615e}{SH\_SqlDataModel::tableName}()\textcolor{keyword}{ const}
00095 \textcolor{keyword}{}\{
00096     \textcolor{keywordflow}{return} \hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable};
00097 \}
00102 \textcolor{keyword}{const} QString &\hyperlink{classSH__SqlDataModel_aa86018df823c85798574ec8d63413c1a}{SH\_SqlDataModel::filter}()\textcolor{keyword}{ const}
00103 \textcolor{keyword}{}\{
00104     \textcolor{keywordflow}{return} \hyperlink{classSH__SqlDataModel_af83c15ae3ad1dc4617dd58f2a852a1e2}{mFilter};
00105 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00110}{}\hyperlink{classSH__SqlDataModel_a571bdc1f9592bd13f98fd748563d46c0}{00110} \textcolor{keyword}{const} QStringList \hyperlink{classSH__SqlDataModel_a571bdc1f9592bd13f98fd748563d46c0}{SH\_SqlDataModel::fieldsList}()\textcolor{keyword}{ const}
00111 \textcolor{keyword}{}\{
00112     QStringList fields;
00113     \textcolor{keywordflow}{if}(!this->\hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.isEmpty()) \{
00114         \textcolor{keywordtype}{int} c = \hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.count();
00115         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < c; i++)
00116         \{
00117             fields .append(this->\hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.at(i)->name());
00118         \}
00119     \}
00120     \textcolor{keywordflow}{return} fields;
00121 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00126}{}\hyperlink{classSH__SqlDataModel_a2c09d14926326a1149c1df7856c9879c}{00126} \textcolor{keywordtype}{void} \hyperlink{classSH__SqlDataModel_a2c09d14926326a1149c1df7856c9879c}{SH\_SqlDataModel::setTable}(\textcolor{keyword}{const} QString &tableName)
00127 \{
00128     \textcolor{keywordflow}{if} (\hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable}.toUpper() != tableName.toUpper() && tableName != \textcolor{stringliteral}{""})
00129     \{
00130         \hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable} = tableName.toUpper();
00131         emit \hyperlink{classSH__SqlDataModel_a791a6cc9d8a2ba109fe5f54ab287dc80}{tableChanged}();
00132     \}
00133 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00138}{}\hyperlink{classSH__SqlDataModel_a99c6317027a7c9f723215b53b69e0647}{00138} \textcolor{keywordtype}{void} \hyperlink{classSH__SqlDataModel_a99c6317027a7c9f723215b53b69e0647}{SH\_SqlDataModel::setFilterCondition}(\textcolor{keyword}{const} QString &filter)
00139 \{
00140     \textcolor{keywordflow}{if} (\hyperlink{classSH__SqlDataModel_af83c15ae3ad1dc4617dd58f2a852a1e2}{mFilter} != filter && filter != \textcolor{stringliteral}{""})
00141     \{
00142         \hyperlink{classSH__SqlDataModel_af83c15ae3ad1dc4617dd58f2a852a1e2}{mFilter} = \hyperlink{classSH__SqlDataModel_aa86018df823c85798574ec8d63413c1a}{filter};
00143         emit \hyperlink{classSH__SqlDataModel_ab7bf039eba1e085b137509b7b93ea39b}{filterChanged}();
00144     \}
00145 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00150}{}\hyperlink{classSH__SqlDataModel_a0bf147a87376fc3aa436562f94661679}{00150} \textcolor{keywordtype}{void} \hyperlink{classSH__SqlDataModel_a0bf147a87376fc3aa436562f94661679}{SH\_SqlDataModel::resetFilterCondition}()
00151 \{
00152     \hyperlink{classSH__SqlDataModel_af83c15ae3ad1dc4617dd58f2a852a1e2}{mFilter} = \textcolor{stringliteral}{""};
00153     emit \hyperlink{classSH__SqlDataModel_ab7bf039eba1e085b137509b7b93ea39b}{filterChanged}();
00154 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00159}{}\hyperlink{classSH__SqlDataModel_ab6c206088250a66ddc8cb8d33a38e421}{00159} \textcolor{keywordtype}{bool} \hyperlink{classSH__SqlDataModel_ab6c206088250a66ddc8cb8d33a38e421}{SH\_SqlDataModel::fetch}(QString tableName, QString filter, QString sort, 
      QStringList fieldsList)
00160 \{
00161     \textcolor{keywordflow}{if}(!\hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable}.isEmpty() || !tableName.isEmpty()) \{
00162         \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(\textcolor{stringliteral}{"Bienvenue dans fetch"});
00163         \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(\hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable} + \textcolor{stringliteral}{" "} + this->
      \hyperlink{classSH__SqlDataModel_a571bdc1f9592bd13f98fd748563d46c0}{fieldsList}().join(\textcolor{stringliteral}{", "}) + \textcolor{stringliteral}{" "} +\hyperlink{classSH__SqlDataModel_af83c15ae3ad1dc4617dd58f2a852a1e2}{mFilter} + \textcolor{stringliteral}{" "} + \hyperlink{classSH__SqlDataModel_a7e36fd116b7cb50e949ee56af0c31772}{mSort});
00164         this->\hyperlink{classSH__SqlDataModel_ad297d359375d55e66493ce8935f8ff05}{setFields}(fieldsList);
00165         this->\hyperlink{classSH__SqlDataModel_a2c09d14926326a1149c1df7856c9879c}{setTable}(tableName);
00166         this->\hyperlink{classSH__SqlDataModel_a99c6317027a7c9f723215b53b69e0647}{setFilterCondition}(filter);
00167         this->\hyperlink{classSH__SqlDataModel_ab443cd7935993270c37f9bd977b33875}{setOrderBy}(sort);
00168         \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(\hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable} + \textcolor{stringliteral}{" "} + this->
      \hyperlink{classSH__SqlDataModel_a571bdc1f9592bd13f98fd748563d46c0}{fieldsList}().join(\textcolor{stringliteral}{", "}) + \textcolor{stringliteral}{" "} +filter + \textcolor{stringliteral}{" "} + sort);
00169         \textcolor{keywordflow}{try}
00170         \{
00171             beginResetModel();
00172             \hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.clear();
00173             endResetModel();
00174             \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(
      \hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable} + \textcolor{stringliteral}{" "} + this->\hyperlink{classSH__SqlDataModel_a571bdc1f9592bd13f98fd748563d46c0}{fieldsList}().join(\textcolor{stringliteral}{", "}) + \textcolor{stringliteral}{" "} +\hyperlink{classSH__SqlDataModel_af83c15ae3ad1dc4617dd58f2a852a1e2}{mFilter} + \textcolor{stringliteral}{" "} + 
      \hyperlink{classSH__SqlDataModel_a7e36fd116b7cb50e949ee56af0c31772}{mSort});
00175             \hyperlink{classSH__SqlDataModel_a54f0cf057e3200f6b199508958e43fec}{mSqlQuery} = \hyperlink{classSH__DatabaseManager_a31198eb4de0f8b18e3fa0eed09f24d19}{SH\_DatabaseManager::getInstance}()->
      \hyperlink{classSH__DatabaseManager_ab8f9850cb68444ab9a4e613b36a3b044}{execSelectQuery}(\hyperlink{classSH__SqlDataModel_a88b8738a0d2803c94295c90c83d65f32}{mTable}, this->\hyperlink{classSH__SqlDataModel_a571bdc1f9592bd13f98fd748563d46c0}{fieldsList}(), 
      \hyperlink{classSH__SqlDataModel_af83c15ae3ad1dc4617dd58f2a852a1e2}{mFilter}, \hyperlink{classSH__SqlDataModel_a7e36fd116b7cb50e949ee56af0c31772}{mSort});
00176             \textcolor{keywordtype}{bool} next = \hyperlink{classSH__SqlDataModel_a54f0cf057e3200f6b199508958e43fec}{mSqlQuery}.next();
00177             \textcolor{comment}{//SH\_MessageManager::infoMessage(mSqlQuery.executedQuery());}
00178             \textcolor{comment}{/*if(next) \{}
00179 \textcolor{comment}{                SH\_MessageManager::debugMessage("next ok");}
00180 \textcolor{comment}{            \}*/}
00181             \textcolor{keywordflow}{while} (next)
00182             \{
00183                 QSqlRecord record = \hyperlink{classSH__SqlDataModel_a54f0cf057e3200f6b199508958e43fec}{mSqlQuery}.record();
00184 
00185                 \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(\textcolor{stringliteral}{"Nouvelle ligne récupérée"});
00186                 \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(QString(\textcolor{stringliteral}{"%1 champs"}).arg(
      record.count()));
00187                 \textcolor{keywordflow}{if} (\hyperlink{classSH__SqlDataModel_a54f0cf057e3200f6b199508958e43fec}{mSqlQuery}.isValid() && (!record.isEmpty()) && (record.count() > 0))
00188                 \{
00189                     beginInsertRows(QModelIndex(), 0, 0);
00190                     \hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.append(record);
00191 \textcolor{comment}{//#ifdef DEBUG}
00192                     \textcolor{keywordtype}{int} nbFields = record.count();
00193                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nbFields; i++)
00194                     \{
00195                         \hyperlink{classSH__MessageManager_a379f2aa0a590a5add34dbe91f98b2ff7}{SH\_MessageManager::debugMessage}(QString(\textcolor{stringliteral}{"%1 : %2"}).
      arg(record.fieldName(i)).arg(record.value(i).toString()));
00196                     \}
00197 \textcolor{comment}{//#endif}
00198                     \textcolor{keywordflow}{if} (\hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.empty())
00199                     \{
00200                         \textcolor{keywordtype}{int} nbFields = record.count();
00201                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nbFields; i++)
00202                         \{
00203                             \hyperlink{classSH__SqlDataFields}{SH\_SqlDataFields} *\hyperlink{classSH__SqlDataModel_a92c51d5c1f6aca08a7ee566ece1e4cb6}{field} = \textcolor{keyword}{new} 
      \hyperlink{classSH__SqlDataFields}{SH\_SqlDataFields}();
00204                             field->\hyperlink{classSH__SqlDataFields_a8d7b864a4ad5513af9e4c47a0d9919e8}{setName}(record.fieldName(i));
00205                             \textcolor{comment}{//SH\_MessageManager::debugMessage(QString("nouveau champ (le n°%1):
       %2").arg(i).arg(field->name()));}
00206                             \hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.append(field);
00207                         \}
00208                         this->\hyperlink{classSH__SqlDataModel_ad4f032ceb7c2f70b2d7388e3afd161ab}{applyRoles}();
00209                         emit \hyperlink{classSH__SqlDataModel_a34a4750c1fb9c7ed05fe869d6de84e28}{fieldsChanged}();
00210                     \}
00211                     endInsertRows();
00212                 \}
00213                 next = \hyperlink{classSH__SqlDataModel_a54f0cf057e3200f6b199508958e43fec}{mSqlQuery}.next();
00214             \}
00215         \}
00216         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::exception &e)
00217         \{
00218             \hyperlink{classSH__MessageManager_a0cb4f06cf67539457482ba1c8544eb06}{SH\_MessageManager::errorMessage}(e.what(), \textcolor{stringliteral}{"exception"});
00219             \textcolor{keywordflow}{if} (this->\hyperlink{classSH__SqlDataModel_ad9aaa1569cd20c3c0e18d39eeb6caa43}{lastError}().isEmpty())
00220             \{
00221                 \hyperlink{classSH__MessageManager_a0cb4f06cf67539457482ba1c8544eb06}{SH\_MessageManager::errorMessage}(this->
      \hyperlink{classSH__SqlDataModel_ad9aaa1569cd20c3c0e18d39eeb6caa43}{lastError}(), \textcolor{stringliteral}{"erreur SQL"});
00222             \}
00223         \}
00224         \textcolor{keywordflow}{if} (this->\hyperlink{classSH__SqlDataModel_ad9aaa1569cd20c3c0e18d39eeb6caa43}{lastError}().\hyperlink{classSH__SqlDataModel_ad85bfde0f7ffb06172eb5543e26d1331}{isEmpty}())
00225         \{
00226             \hyperlink{classSH__MessageManager_a0cb4f06cf67539457482ba1c8544eb06}{SH\_MessageManager::errorMessage}(this->
      \hyperlink{classSH__SqlDataModel_ad9aaa1569cd20c3c0e18d39eeb6caa43}{lastError}(), \textcolor{stringliteral}{"erreur SQL"});
00227         \}
00228     \}
00229     \textcolor{keywordflow}{return} (!this->\hyperlink{classSH__SqlDataModel_ad85bfde0f7ffb06172eb5543e26d1331}{isEmpty}());
00230 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00235}{}\hyperlink{classSH__SqlDataModel_a92c51d5c1f6aca08a7ee566ece1e4cb6}{00235} \hyperlink{classSH__SqlDataFields}{SH\_SqlDataFields} *\hyperlink{classSH__SqlDataModel_a92c51d5c1f6aca08a7ee566ece1e4cb6}{SH\_SqlDataModel::field}(\textcolor{keywordtype}{int} i)\textcolor{keyword}{ const}
00236 \textcolor{keyword}{}\{
00237     i = qMin(i, this->\hyperlink{classSH__SqlDataModel_a46f0951fd358e30892a982ebd34e43c2}{fieldsCount}()-1);
00238     i = qMax(i, 0);
00239     \textcolor{keywordflow}{return} this->\hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.at(i);
00240 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00245}{}\hyperlink{classSH__SqlDataModel_ad297d359375d55e66493ce8935f8ff05}{00245} \textcolor{keywordtype}{void} \hyperlink{classSH__SqlDataModel_ad297d359375d55e66493ce8935f8ff05}{SH\_SqlDataModel::setFields}(QStringList fields)
00246 \{
00247     fields.removeDuplicates();
00248     \textcolor{keywordtype}{int} nbFields = fields.count();
00249     \textcolor{keywordflow}{if} (nbFields > 0)
00250     \{
00251         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nbFields; i++)
00252         \{
00253             \hyperlink{classSH__SqlDataFields}{SH\_SqlDataFields} *\hyperlink{classSH__SqlDataModel_a92c51d5c1f6aca08a7ee566ece1e4cb6}{field} = \textcolor{keyword}{new} \hyperlink{classSH__SqlDataFields}{SH\_SqlDataFields}();
00254             field->\hyperlink{classSH__SqlDataFields_a8d7b864a4ad5513af9e4c47a0d9919e8}{setName}(fields.at(i));
00255             \hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.append(field);
00256         \}
00257         this->\hyperlink{classSH__SqlDataModel_ad4f032ceb7c2f70b2d7388e3afd161ab}{applyRoles}();
00258         emit \hyperlink{classSH__SqlDataModel_a34a4750c1fb9c7ed05fe869d6de84e28}{fieldsChanged}();
00259     \}
00260 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00265}{}\hyperlink{classSH__SqlDataModel_ad0477d16e78ba808250e2054952f9833}{00265} \textcolor{keywordtype}{void} \hyperlink{classSH__SqlDataModel_ad0477d16e78ba808250e2054952f9833}{SH\_SqlDataModel::resetFieldsToAll}()
00266 \{
00267     \hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.clear();
00268     this->\hyperlink{classSH__SqlDataModel_ad4f032ceb7c2f70b2d7388e3afd161ab}{applyRoles}();
00269     emit \hyperlink{classSH__SqlDataModel_a34a4750c1fb9c7ed05fe869d6de84e28}{fieldsChanged}();
00270 \}
00275 \textcolor{keyword}{const} QString \hyperlink{classSH__SqlDataModel_ad9aaa1569cd20c3c0e18d39eeb6caa43}{SH\_SqlDataModel::lastError}()
00276 \{
00277     QSqlError error = \hyperlink{classSH__SqlDataModel_a54f0cf057e3200f6b199508958e43fec}{mSqlQuery}.lastError();
00278     \textcolor{keywordflow}{if} (error.isValid() && !error.text().isEmpty())
00279     \{
00280         emit \hyperlink{classSH__SqlDataModel_a16f5316d5ca383f137d0d571931e4cc5}{lastErrorChanged}();
00281         \textcolor{keywordflow}{return} error.text();
00282     \}
00283     \textcolor{keywordflow}{else}
00284     \{
00285         \textcolor{keywordflow}{return} \textcolor{stringliteral}{""};
00286     \}
00287 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00292}{}\hyperlink{classSH__SqlDataModel_ad4f032ceb7c2f70b2d7388e3afd161ab}{00292} \textcolor{keywordtype}{void} \hyperlink{classSH__SqlDataModel_ad4f032ceb7c2f70b2d7388e3afd161ab}{SH\_SqlDataModel::applyRoles}()
00293 \{
00294     this->\hyperlink{classSH__SqlDataModel_ad1e46c72a6aeb83e3e7bb0c3110d12a4}{mRoles}.clear();
00295     \textcolor{keywordtype}{int} nbFields = this->\hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.count();
00296     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < nbFields; i++)
00297     \{
00298         this->\hyperlink{classSH__SqlDataModel_ad1e46c72a6aeb83e3e7bb0c3110d12a4}{mRoles}.insert(this->\hyperlink{classSH__SqlDataModel_aa487bb763eaf2544e4eb5822cd666105}{roleForField}(i), this->
      \hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.at(i)->role());
00299     \}
00300     emit \hyperlink{classSH__SqlDataModel_acf85dacdcc946ef27377d221b16b0e41}{rolesChanged}();
00301 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00306}{}\hyperlink{classSH__SqlDataModel_a46f0951fd358e30892a982ebd34e43c2}{00306} \textcolor{keywordtype}{int} \hyperlink{classSH__SqlDataModel_a46f0951fd358e30892a982ebd34e43c2}{SH\_SqlDataModel::fieldsCount}()\textcolor{keyword}{ const}
00307 \textcolor{keyword}{}\{
00308     \textcolor{keywordflow}{return} \hyperlink{classSH__SqlDataModel_a3e998f75dd5b3193783612002461888d}{mDataFields}.count();
00309 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00314}{}\hyperlink{classSH__SqlDataModel_ab443cd7935993270c37f9bd977b33875}{00314} \textcolor{keywordtype}{void} \hyperlink{classSH__SqlDataModel_ab443cd7935993270c37f9bd977b33875}{SH\_SqlDataModel::setOrderBy}(QString sort)
00315 \{
00316     this->\hyperlink{classSH__SqlDataModel_a7e36fd116b7cb50e949ee56af0c31772}{mSort} = sort;
00317 \}
\hypertarget{SH__SqlDataModel_8cpp_source_l00322}{}\hyperlink{classSH__SqlDataModel_ad85bfde0f7ffb06172eb5543e26d1331}{00322} \textcolor{keywordtype}{bool} \hyperlink{classSH__SqlDataModel_ad85bfde0f7ffb06172eb5543e26d1331}{SH\_SqlDataModel::isEmpty}()\textcolor{keyword}{ const}
00323 \textcolor{keyword}{}\{
00324     \textcolor{keywordflow}{return} \hyperlink{classSH__SqlDataModel_aa58096989daac3cd3fdea5e6dd4f27ee}{mRecords}.empty();
00325 \}
00326 \textcolor{comment}{/*\}*/}
\end{DoxyCode}
