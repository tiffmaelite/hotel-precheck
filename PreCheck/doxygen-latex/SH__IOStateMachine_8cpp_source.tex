\hypertarget{SH__IOStateMachine_8cpp}{\section{S\-H\-\_\-\-I\-O\-State\-Machine.\-cpp}
\label{SH__IOStateMachine_8cpp}\index{/home/tiff/\-Stage-\/\-I\-U\-T/app/simplhotel/hotel-\/precheck/src/\-Pre\-Check/logic/\-S\-H\-\_\-\-I\-O\-State\-Machine.\-cpp@{/home/tiff/\-Stage-\/\-I\-U\-T/app/simplhotel/hotel-\/precheck/src/\-Pre\-Check/logic/\-S\-H\-\_\-\-I\-O\-State\-Machine.\-cpp}}
}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{SH__IOStateMachine_8h}{SH\_IOStateMachine.h}"}
00002 \textcolor{preprocessor}{#include "\hyperlink{SH__ValidationState_8h}{SH\_ValidationState.h}"}
00003 \textcolor{preprocessor}{#include "\hyperlink{SH__ConfirmationState_8h}{SH\_ConfirmationState.h}"}
00004 \textcolor{preprocessor}{#include "\hyperlink{SH__FileSelectionState_8h}{SH\_FileSelectionState.h}"}
00005 \textcolor{preprocessor}{#include "\hyperlink{SH__DateQuestionState_8h}{SH\_DateQuestionState.h}"}
00006 \textcolor{preprocessor}{#include "\hyperlink{SH__AdaptDatabaseState_8h}{SH\_AdaptDatabaseState.h}"}
00007 
\hypertarget{SH__IOStateMachine_8cpp_source_l00013}{}\hyperlink{classSH__InOutStateMachine_abd780037922920c674b43d80c2b50d16}{00013} \hyperlink{classSH__InOutStateMachine_abd780037922920c674b43d80c2b50d16}{SH\_InOutStateMachine::SH\_InOutStateMachine}(QString tableName, 
      QString name, \hyperlink{classQObject}{QObject} *parent) :
00014     \hyperlink{classSH__GenericStateMachine}{SH\_GenericStateMachine}(name, parent), m\_tableName(tableName), m\_isRunning(false)
00015 \{
00016     qDebug() << \textcolor{stringliteral}{"nouvelle IOStateMachine"};
00017     \hyperlink{classSH__InOutStateMachine_a7c65b7b5356594770172c130330fedf0}{m\_errorState} = \textcolor{keyword}{new} \hyperlink{classSH__GenericState}{SH\_GenericState}(\textcolor{stringliteral}{"error state"});
00018     connect(\hyperlink{classSH__InOutStateMachine_a7c65b7b5356594770172c130330fedf0}{m\_errorState}, &QState::entered, [=]() \{ qDebug() << \textcolor{stringliteral}{"Error in machine "} << this->
      \hyperlink{classSH__GenericStateMachine_a85c0c1c9d258ae991f84667412fa47cd}{toString}() << \textcolor{stringliteral}{": "} << this->errorString(); \});
00019 \}
00020 
00021 
00022 
\hypertarget{SH__IOStateMachine_8cpp_source_l00029}{}\hyperlink{classSH__InOutStateMachine_aaca105fbd5f5cc3bac115389ad3694c5}{00029} QVariantMap \hyperlink{classSH__InOutStateMachine_aaca105fbd5f5cc3bac115389ad3694c5}{SH\_InOutStateMachine::ioContent}()\textcolor{keyword}{ const}
00030 \textcolor{keyword}{}\{
00031     \textcolor{keywordflow}{return} \hyperlink{classSH__InOutStateMachine_a8cfbc27eef057bf37b7711bdfef2077e}{m\_ioContent};
00032 \}
00033 
\hypertarget{SH__IOStateMachine_8cpp_source_l00040}{}\hyperlink{classSH__InOutStateMachine_a8271a7ec7d5f6502449dd3b4da5f4155}{00040} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_a8271a7ec7d5f6502449dd3b4da5f4155}{SH\_InOutStateMachine::setIOcontent}(\textcolor{keyword}{const} QVariantMap &ioContent)
00041 \{
00042     \hyperlink{classSH__InOutStateMachine_a8cfbc27eef057bf37b7711bdfef2077e}{m\_ioContent} = \hyperlink{classSH__InOutStateMachine_aaca105fbd5f5cc3bac115389ad3694c5}{ioContent};
00043 \}
00044 
\hypertarget{SH__IOStateMachine_8cpp_source_l00051}{}\hyperlink{classSH__InOutStateMachine_aa1a3bd3c0ea8a59b9bc916dc718eb9ca}{00051} QVariant \hyperlink{classSH__InOutStateMachine_aa1a3bd3c0ea8a59b9bc916dc718eb9ca}{SH\_InOutStateMachine::getContentValue}(QString field)
00052 \{
00053     \textcolor{keywordflow}{return} \hyperlink{classSH__InOutStateMachine_a8cfbc27eef057bf37b7711bdfef2077e}{m\_ioContent}.value(field);
00054 \}
00055 
\hypertarget{SH__IOStateMachine_8cpp_source_l00062}{}\hyperlink{classSH__InOutStateMachine_a4288a6c86ddf83effefff886675591c9}{00062} QString \hyperlink{classSH__InOutStateMachine_a4288a6c86ddf83effefff886675591c9}{SH\_InOutStateMachine::tableName}()\textcolor{keyword}{ const}
00063 \textcolor{keyword}{}\{
00064     \textcolor{keywordflow}{return} \hyperlink{classSH__InOutStateMachine_aa009eecc5ab6181358faafb5996b6006}{m\_tableName};
00065 \}
00066 
\hypertarget{SH__IOStateMachine_8cpp_source_l00073}{}\hyperlink{classSH__InOutStateMachine_a95db31a7e7f31f36a8737adc739ab08c}{00073} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_a95db31a7e7f31f36a8737adc739ab08c}{SH\_InOutStateMachine::setTableName}(\textcolor{keyword}{const} QString &tableName)
00074 \{
00075     \hyperlink{classSH__InOutStateMachine_aa009eecc5ab6181358faafb5996b6006}{m\_tableName} = \hyperlink{classSH__InOutStateMachine_a4288a6c86ddf83effefff886675591c9}{tableName};
00076 \}
00077 
00078 
\hypertarget{SH__IOStateMachine_8cpp_source_l00085}{}\hyperlink{classSH__InOutStateMachine_a9ab1534306b2bdb62743d4bcefe40c17}{00085} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_a9ab1534306b2bdb62743d4bcefe40c17}{SH\_InOutStateMachine::setContentValue}(QVariant content, QString 
      field)
00086 \{
00087     \hyperlink{classSH__InOutStateMachine_a8cfbc27eef057bf37b7711bdfef2077e}{m\_ioContent}.insert(field, content);
00088 \}
00089 
\hypertarget{SH__IOStateMachine_8cpp_source_l00096}{}\hyperlink{classSH__InOutStateMachine_a2528cffddbe6f98c32ebef41423c0118}{00096} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_a2528cffddbe6f98c32ebef41423c0118}{SH\_InOutStateMachine::addIOState}(
      \hyperlink{classSH__InOutState}{SH\_InOutState} *state, QString field)
00097 \{
00098     \textcolor{comment}{/*à faire au moment de l'entrée dans l'état state*/}
00099     connect(state, &QState::entered, [=]() \{
00100         qDebug() << state->\hyperlink{classSH__GenericState_a7779babbb40f3f8faa71112204d9804f}{toString}() << \textcolor{stringliteral}{"entered !"};
00101         state->\hyperlink{classSH__InOutState_a616f88b20478b81b2927a9ddc2b4f521}{display}(\textcolor{keyword}{true});
00102         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a037ed5e13ecfae2123a8d4940292e410}{SH\_InOutStateMachine::receiveInput}, state, &
      \hyperlink{classSH__InOutState_aaec9c2b5ef7c406bff7469461352d47c}{SH\_InOutState::setInput}, Qt::QueuedConnection); \textcolor{comment}{/* la réception d'une valeur
       entraîne son enregistrement comme entrée de l'utilisateur auprès de l'état*/}
00103         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a037ed5e13ecfae2123a8d4940292e410}{SH\_InOutStateMachine::receiveInput}, [=](QString in
      )\{ qDebug() << state->\hyperlink{classSH__GenericState_a7779babbb40f3f8faa71112204d9804f}{toString}() << \textcolor{stringliteral}{"hello world !"}; state->\hyperlink{classSH__InOutState_aaec9c2b5ef7c406bff7469461352d47c}{setInput}(in);\}); \textcolor{comment}{/* la réception
       d'une valeur entraîne son enregistrement comme entrée de l'utilisateur auprès de l'état*/}
00104         connect(state, &\hyperlink{classSH__InOutState_af611c84134e262739cd834797b315c80}{SH\_InOutState::setOutput}, [=](QVariant out) \{qDebug() << 
      state->\hyperlink{classSH__GenericState_a7779babbb40f3f8faa71112204d9804f}{toString}() << \textcolor{stringliteral}{"out !"};\});
00105         connect(state, &\hyperlink{classSH__InOutState_a77921c5f42059bc97361f4ff7827da12}{SH\_InOutState::sendOutput}, [=](QVariant out) \{qDebug() << 
      state->\hyperlink{classSH__GenericState_a7779babbb40f3f8faa71112204d9804f}{toString}() << \textcolor{stringliteral}{"connected !"}; emit this->\hyperlink{classSH__InOutStateMachine_a5e7f5958bae31696b6a8deab94ad2b4f}{sendText}(out.toString(), \textcolor{keyword}{false});\});
00106         connect(state, &\hyperlink{classSH__InOutState_a1f00480afefd173002cf56d4c4128048}{SH\_InOutState::resendInput}, [=](QVariant in) \{emit this->
      \hyperlink{classSH__InOutStateMachine_a526822c66b46aa0cd81ba4473fa5573f}{resendText}(in.toString(), \textcolor{keyword}{true});\});
00107         \textcolor{keywordflow}{if}(state->\hyperlink{classSH__InOutState_a3a18752c4122c26a2ebf38310c9c1b75}{visibility}()) \{
00108             state->\hyperlink{classSH__InOutState_a77921c5f42059bc97361f4ff7827da12}{sendOutput}(QVariant(state->\hyperlink{classSH__InOutState_a17ed7eaf5e3ed5af80a4f9fe65d5bfd9}{output}()));
00109         \} \textcolor{keywordflow}{else} \{
00110             qDebug() << \textcolor{stringliteral}{"invisible"};
00111         \}
00112     \});
00113     \hyperlink{classSH__ValidationState}{SH\_ValidationState} *validationState = qobject\_cast<
      \hyperlink{classSH__ValidationState}{SH\_ValidationState}*>(state);
00114     \textcolor{keywordflow}{if}(validationState) \{
00115         \textcolor{comment}{/*à faire au moment de l'entrée dans l'état state*/}
00116         connect(validationState, &QState::entered, [=]() \{
00117             connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_aec1b3fef3c1f82499aa1f73beaecd08a}{SH\_InOutStateMachine::validateInput}, 
      validationState, &\hyperlink{classSH__ConfirmationState_a039267260de5d102ac7511e6a5fae87f}{SH\_ValidationState::confirmInput}, Qt::QueuedConnection);
00118         \});
00119     \}
00120     \hyperlink{classSH__ConfirmationState}{SH\_ConfirmationState} *confirmationState = qobject\_cast<
      \hyperlink{classSH__ConfirmationState}{SH\_ConfirmationState}*>(state);
00121     \textcolor{keywordflow}{if}(confirmationState) \{
00122         \textcolor{comment}{/*à faire au moment de l'entrée dans l'état state*/}
00123         connect(confirmationState, &QState::entered, [=]() \{
00124             connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_aec1b3fef3c1f82499aa1f73beaecd08a}{SH\_InOutStateMachine::validateInput}, 
      confirmationState, &\hyperlink{classSH__ConfirmationState_a039267260de5d102ac7511e6a5fae87f}{SH\_ConfirmationState::confirmInput}, Qt::QueuedConnection);
00125         \});
00126     \}
00127     \hyperlink{classSH__DateQuestionState}{SH\_DateQuestionState} *dateState = qobject\_cast<
      \hyperlink{classSH__DateQuestionState}{SH\_DateQuestionState}*>(state);
00128     \textcolor{keywordflow}{if}(dateState) \{
00129         \textcolor{comment}{/*à faire au moment de l'entrée dans l'état state*/}
00130         connect(dateState, &QState::entered, \textcolor{keyword}{this}, &
      \hyperlink{classSH__InOutStateMachine_ab3a12d1f9b658d8ffdc17669a6c065f2}{SH\_InOutStateMachine::displayCalendar}, Qt::QueuedConnection);
00131     \}
00132     \hyperlink{classSH__FileSelectionState}{SH\_FileSelectionState} *fileState = qobject\_cast<
      \hyperlink{classSH__FileSelectionState}{SH\_FileSelectionState}*>(state);
00133     \textcolor{keywordflow}{if}(fileState) \{
00134         \textcolor{comment}{/*à faire au moment de l'entrée dans l'état state*/}
00135         connect(fileState, &QState::entered, \textcolor{keyword}{this}, &
      \hyperlink{classSH__InOutStateMachine_abd206c3bc32bb7690df9c3e1cd546ebc}{SH\_InOutStateMachine::displayFileDialog}, Qt::QueuedConnection);
00136     \}
00137     \textcolor{comment}{/*à faire au moment de la sortie de l'état state*/}
00138     connect(state, &QState::exited, [=]() \{
00139         qDebug() << \textcolor{stringliteral}{"exited !"};
00140         \textcolor{keywordflow}{if}(!field.isEmpty()) \{
00141             \hyperlink{classSH__InOutStateMachine_a9ab1534306b2bdb62743d4bcefe40c17}{setContentValue}(state->\hyperlink{classSH__InOutState_a4c674a54f41d2e6ef951b22393dcd89f}{rawInput}(), field);
00142             \textcolor{comment}{/*gestion de l'historique des états pour pouvoir revenir à l'état state après l'avoir quitté*/}
00143             QHistoryState* hState = \textcolor{keyword}{new} QHistoryState(state);
00144             \hyperlink{classSH__InOutStateMachine_acbcce2c4300af1634d928b30e5e9be1c}{setIOStateHistory}(hState, field);
00145         \}
00146         state->disconnect(\textcolor{keyword}{this}); \textcolor{comment}{/*plus aucune action sur l'état ne pourra être provoquée par la machine*/}
00147     \});
00148 
00149 
00150     QAbstractState* astate = qobject\_cast<QAbstractState *>(state);
00151     \textcolor{keywordflow}{if}(astate) \{
00152         addState(astate);
00153     \}
00154 \}
00155 
\hypertarget{SH__IOStateMachine_8cpp_source_l00162}{}\hyperlink{classSH__InOutStateMachine_a6f65dff277508e650eb697628c857b19}{00162} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_a6f65dff277508e650eb697628c857b19}{SH\_InOutStateMachine::addIOStateMachine}(
      \hyperlink{classSH__InOutStateMachine}{SH\_InOutStateMachine} *fsm)
00163 \{
00164     \textcolor{comment}{/*à faire au moment de l'entrée dans la machine d'état fsm*/}
00165     connect(fsm, &QState::entered, [=]() \{
00166         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a037ed5e13ecfae2123a8d4940292e410}{SH\_InOutStateMachine::receiveInput}, fsm, &
      \hyperlink{classSH__InOutStateMachine_a037ed5e13ecfae2123a8d4940292e410}{SH\_InOutStateMachine::receiveInput},Qt::QueuedConnection);
00167         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a5e7f5958bae31696b6a8deab94ad2b4f}{SH\_InOutStateMachine::sendText}, fsm, &
      \hyperlink{classSH__InOutStateMachine_a5e7f5958bae31696b6a8deab94ad2b4f}{SH\_InOutStateMachine::sendText},Qt::QueuedConnection);
00168         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a526822c66b46aa0cd81ba4473fa5573f}{SH\_InOutStateMachine::resendText}, fsm, &
      \hyperlink{classSH__InOutStateMachine_a526822c66b46aa0cd81ba4473fa5573f}{SH\_InOutStateMachine::resendText},Qt::QueuedConnection);
00169         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a7f7d9c9300c1d05bce2c26029f28cc31}{SH\_InOutStateMachine::confirmInput}, fsm, &
      \hyperlink{classSH__InOutStateMachine_a7f7d9c9300c1d05bce2c26029f28cc31}{SH\_InOutStateMachine::confirmInput},Qt::QueuedConnection);
00170         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_aec1b3fef3c1f82499aa1f73beaecd08a}{SH\_InOutStateMachine::validateInput}, fsm, &
      \hyperlink{classSH__InOutStateMachine_aec1b3fef3c1f82499aa1f73beaecd08a}{SH\_InOutStateMachine::validateInput},Qt::QueuedConnection);
00171         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a9fa5db44086de2576c812f631aa4f60a}{SH\_InOutStateMachine::replaceInput}, fsm, &
      \hyperlink{classSH__InOutStateMachine_a9fa5db44086de2576c812f631aa4f60a}{SH\_InOutStateMachine::replaceInput},Qt::QueuedConnection);
00172         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a035d37535533d4805fe2606f38c19380}{SH\_InOutStateMachine::cancelReplacement}, fsm,
       &\hyperlink{classSH__InOutStateMachine_a035d37535533d4805fe2606f38c19380}{SH\_InOutStateMachine::cancelReplacement},Qt::QueuedConnection);
00173         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_ab3a12d1f9b658d8ffdc17669a6c065f2}{SH\_InOutStateMachine::displayCalendar}, fsm, &
      \hyperlink{classSH__InOutStateMachine_ab3a12d1f9b658d8ffdc17669a6c065f2}{SH\_InOutStateMachine::displayCalendar},Qt::QueuedConnection);
00174     \});
00175     \textcolor{comment}{/*à faire au moment de la sortie de la machine d'état fsm*/}
00176     connect(fsm, &QState::exited, [=]() \{
00177         fsm->disconnect(\textcolor{keyword}{this}); \textcolor{comment}{/*plus aucune action sur la machine d'état fille ne pourra être provoquée
       par la machine mère*/}
00178     \});
00179 
00180 \}
00181 
00182 
\hypertarget{SH__IOStateMachine_8cpp_source_l00189}{}\hyperlink{classSH__InOutStateMachine_a13889998c6dcd17db984dd6ed1454e80}{00189} QMap<QString, QHistoryState *> \hyperlink{classSH__InOutStateMachine_a13889998c6dcd17db984dd6ed1454e80}{SH\_InOutStateMachine::ioStatesHistory}()\textcolor{keyword}{
       const}
00190 \textcolor{keyword}{}\{
00191     \textcolor{keywordflow}{return} \hyperlink{classSH__InOutStateMachine_ac46ad1af230e1b2156d805275690dec3}{m\_ioStatesHistory};
00192 \}
00193 
00194 
\hypertarget{SH__IOStateMachine_8cpp_source_l00201}{}\hyperlink{classSH__InOutStateMachine_af51f92c37d00a4eec4da42113cfd7d73}{00201} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_af51f92c37d00a4eec4da42113cfd7d73}{SH\_InOutStateMachine::setIOStatesHistory}(\textcolor{keyword}{const} QMap<QString,
       QHistoryState *> &ioStatesHistory)
00202 \{
00203     \hyperlink{classSH__InOutStateMachine_ac46ad1af230e1b2156d805275690dec3}{m\_ioStatesHistory} = \hyperlink{classSH__InOutStateMachine_a13889998c6dcd17db984dd6ed1454e80}{ioStatesHistory};
00204 \}
00205 
00206 
\hypertarget{SH__IOStateMachine_8cpp_source_l00213}{}\hyperlink{classSH__InOutStateMachine_acbcce2c4300af1634d928b30e5e9be1c}{00213} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_acbcce2c4300af1634d928b30e5e9be1c}{SH\_InOutStateMachine::setIOStateHistory}(QHistoryState *state, 
      QString field)
00214 \{
00215     \hyperlink{classSH__InOutStateMachine_ac46ad1af230e1b2156d805275690dec3}{m\_ioStatesHistory}.insert(field, state); \textcolor{comment}{/*remplacement si plusieurs fois*/}
00216 \}
00217 
00218 
\hypertarget{SH__IOStateMachine_8cpp_source_l00225}{}\hyperlink{classSH__InOutStateMachine_af71bfdb3b59b7bf2763588b513b4205f}{00225} QHistoryState *\hyperlink{classSH__InOutStateMachine_af71bfdb3b59b7bf2763588b513b4205f}{SH\_InOutStateMachine::historyValue}(QString field)
00226 \{
00227     \textcolor{keywordflow}{return} \hyperlink{classSH__InOutStateMachine_ac46ad1af230e1b2156d805275690dec3}{m\_ioStatesHistory}.value(field);
00228 \}
00229 
00230 
00231 
\hypertarget{SH__IOStateMachine_8cpp_source_l00238}{}\hyperlink{classSH__InOutStateMachine_ae0f3b4622d2c70884bb224dee86e95c0}{00238} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_ae0f3b4622d2c70884bb224dee86e95c0}{SH\_InOutStateMachine::addChildrenReplaceTransition}(
      QAbstractState *previousState, QAbstractState *nextState)
00239 \{
00240         \hyperlink{classSH__GenericState}{SH\_GenericState}* genPreviousState = qobject\_cast<
      \hyperlink{classSH__GenericState}{SH\_GenericState}*>(previousState);
00241     \textcolor{keywordflow}{if}(genPreviousState) \{
00242         \textcolor{comment}{/*à faire au moment de l'entrée dans l'état previousState*/}
00243         connect(\textcolor{keyword}{this}, &\hyperlink{classSH__InOutStateMachine_a9fa5db44086de2576c812f631aa4f60a}{SH\_InOutStateMachine::replaceInput}, [=](QString 
      field) \{
00244             \textcolor{keywordflow}{if}(genPreviousState->\hyperlink{classSH__GenericState_a5f731810dad0cacd28828ccbf1539e4e}{isRunning}()) \{
00245                 \textcolor{comment}{/*après avoir demandé à revenir sur un état précédent, on attend la fin de l'état actuel
       puis on retourne à l'historique de l'état désiré; celui-ci fini, on passe à l'état qui aurait du suivre celui
       pendant lequel on a demandé à revenir sur un état précédent*/}
00246                 QHistoryState* hState = \hyperlink{classSH__InOutStateMachine_af71bfdb3b59b7bf2763588b513b4205f}{historyValue}(field);
00247                 \textcolor{keywordflow}{if}(hState) \{ \textcolor{comment}{/*si l'historique existe (on a déjà quitté l'état voulu)*/}
00248                     hState->parentState()->addTransition(hState->parentState(), SIGNAL(
      \hyperlink{classSH__GenericStateMachine_af4771d31d87951c997fba1633c2d67f6}{next}()), nextState);
00249                     genPreviousState->addTransition(genPreviousState, SIGNAL(
      \hyperlink{classSH__GenericStateMachine_af4771d31d87951c997fba1633c2d67f6}{next}()), hState);
00250                 \}
00251             \}
00252         \});
00253     \}
00254 \}
00255 
\hypertarget{SH__IOStateMachine_8cpp_source_l00262}{}\hyperlink{classSH__InOutStateMachine_aa78420f8778d7777809aad77eb8473b4}{00262} \textcolor{keywordtype}{void} \hyperlink{classSH__InOutStateMachine_aa78420f8778d7777809aad77eb8473b4}{SH\_InOutStateMachine::addChildrenNextTransition}(
      QAbstractState *previousState, QAbstractState *nextState)
00263 \{
00264     \hyperlink{classSH__GenericStateMachine}{SH\_GenericStateMachine}* fsmPreviousState = qobject\_cast<
      \hyperlink{classSH__GenericStateMachine}{SH\_GenericStateMachine}*>(previousState);
00265     \hyperlink{classSH__GenericState}{SH\_GenericState}* genPreviousState = qobject\_cast<
      \hyperlink{classSH__GenericState}{SH\_GenericState}*>(previousState);
00266     QFinalState* \textcolor{keyword}{final} = qobject\_cast<QFinalState*>(nextState);
00267     \textcolor{keywordflow}{if}(\textcolor{keyword}{final}) \{
00268         \hyperlink{classSH__AdaptDatabaseState}{SH\_AdaptDatabaseState}* saveState = \textcolor{keyword}{new} 
      \hyperlink{classSH__AdaptDatabaseState}{SH\_AdaptDatabaseState}(\textcolor{stringliteral}{"enregistrement de la machine "}+
      \hyperlink{classSH__GenericStateMachine_a85c0c1c9d258ae991f84667412fa47cd}{toString}());
00269         \textcolor{keywordflow}{if}(genPreviousState) \{
00270             genPreviousState->addTransition(genPreviousState, SIGNAL(\hyperlink{classSH__GenericStateMachine_af4771d31d87951c997fba1633c2d67f6}{next}()), saveState);
00271         \}
00272         \textcolor{keywordflow}{if}(fsmPreviousState) \{
00273             fsmPreviousState->addTransition(fsmPreviousState, SIGNAL(\hyperlink{classSH__GenericStateMachine_af4771d31d87951c997fba1633c2d67f6}{next}()), saveState);
00274         \}
00275         \textcolor{keywordflow}{if}(genPreviousState || fsmPreviousState) \{
00276             connect(previousState, &QAbstractState::exited, [=]() \{
00277                 connect(saveState, &QAbstractState::entered, [=]() \{
00278                     emit this->\hyperlink{classSH__InOutStateMachine_a5e7f5958bae31696b6a8deab94ad2b4f}{sendText}(\textcolor{stringliteral}{"Merci !"});
00279                     \hyperlink{classSH__InOutStateMachine_a9ab1534306b2bdb62743d4bcefe40c17}{setContentValue}(saveState->\hyperlink{classSH__AdaptDatabaseState_a037db544ea05f42d21fcbdda758839fe}{insertUpdate}(
      \hyperlink{classSH__InOutStateMachine_aa009eecc5ab6181358faafb5996b6006}{m\_tableName}, \hyperlink{classSH__InOutStateMachine_a8cfbc27eef057bf37b7711bdfef2077e}{m\_ioContent}), \textcolor{stringliteral}{"ID"});
00280                     emit this->\hyperlink{classSH__InOutStateMachine_aa1d5860888c96ff94c55dc77e0fdfdcf}{clearAll}();
00281                 \});
00282             \});
00283             saveState->addTransition(saveState, SIGNAL(\hyperlink{classSH__GenericStateMachine_af4771d31d87951c997fba1633c2d67f6}{next}()),\textcolor{keyword}{final});
00284         \}
00285     \}
00286     \hyperlink{classSH__GenericStateMachine_a16d844020bc26480bd81d6b794c8364c}{SH\_GenericStateMachine::addChildrenNextTransition}(
      previousState, nextState);
00287 \}
00288 
00289 
\end{DoxyCode}
