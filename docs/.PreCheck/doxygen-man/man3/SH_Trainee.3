.TH "SH_Trainee" 3 "Jeudi Juin 20 2013" "Version 0.3" "PreCheck" \" -*- nroff -*-
.ad l
.nh
.SH NAME
SH_Trainee \- 
.SH SYNOPSIS
.br
.PP
.PP
\fC#include <SH_Trainee\&.h>\fP
.PP
Est dérivée de \fBSH_User\fP\&.
.SS "Connecteurs publics"

.in +1c
.ti -1c
.RI "static QVariant \fBexists\fP (QVariant login)"
.br
.in -1c
.SS "Signaux"

.in +1c
.ti -1c
.RI "void \fBnameChanged\fP ()"
.br
.ti -1c
.RI "void \fBrolesChanged\fP ()"
.br
.ti -1c
.RI "void \fBvalidityChanged\fP ()"
.br
.in -1c
.SS "Fonctions membres publiques"

.in +1c
.ti -1c
.RI "\fBSH_Trainee\fP (QString \fBname\fP, int \fBid\fP, \fBQObject\fP *parent=0)"
.br
.ti -1c
.RI "int \fBid\fP () const "
.br
.ti -1c
.RI "bool \fBisAdministrator\fP () const "
.br
.ti -1c
.RI "bool \fBisManagerX\fP () const "
.br
.ti -1c
.RI "bool \fBisManagerZ\fP () const "
.br
.ti -1c
.RI "bool \fBisReceptionist\fP () const "
.br
.ti -1c
.RI "bool \fBisValid\fP () const "
.br
.ti -1c
.RI "QString \fBname\fP () const "
.br
.ti -1c
.RI "int \fBroles\fP () const "
.br
.in -1c
.SS "Fonctions membres publiques statiques"

.in +1c
.ti -1c
.RI "static \fBSH_User\fP * \fBlogIn\fP (QString login, QString pass)"
.br
.ti -1c
.RI "static bool \fBtraineeExists\fP (QString login)"
.br
.ti -1c
.RI "static bool \fBuserExists\fP (QString login)"
.br
.in -1c
.SS "Propriétés"

.in +1c
.ti -1c
.RI "bool \fBadministrator\fP"
.br
.ti -1c
.RI "int \fBid\fP"
.br
.ti -1c
.RI "bool \fBmanagerX\fP"
.br
.ti -1c
.RI "bool \fBmanagerZ\fP"
.br
.ti -1c
.RI "QString \fBname\fP"
.br
.ti -1c
.RI "bool \fBreceptionist\fP"
.br
.ti -1c
.RI "int \fBroles\fP"
.br
.ti -1c
.RI "bool \fBvalid\fP"
.br
.in -1c
.SH "Description détaillée"
.PP 
Définition à la ligne 14 du fichier SH_Trainee\&.h\&.
.SH "Documentation des constructeurs et destructeur"
.PP 
.SS "SH_Trainee::SH_Trainee (QStringname, intid, \fBQObject\fP *parent = \fC0\fP)"

.PP
\fBParamètres:\fP
.RS 4
\fIname\fP 
.br
\fIid\fP 
.br
\fIparent\fP 
.RE
.PP

.PP
Définition à la ligne 9 du fichier SH_Trainee\&.cpp\&.
.PP
.nf
9                                                             : SH_User(name, id, true, false, false, false, parent)
10 {
11 
12 }
.fi
.SH "Documentation des fonctions membres"
.PP 
.SS "static QVariant SH_User::exists (QVariantlogin)\fC [inline]\fP, \fC [static]\fP, \fC [slot]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 132 du fichier SH_User\&.h\&.
.PP
Références SH_User::traineeExists(), et SH_User::userExists()\&.
.PP
Référencé par SH_ApplicationCore::setMode(), et SH_ApplicationCore::userExists()\&.
.PP
.nf
132 {return QVariant(SH_User::userExists(login\&.toString()) || SH_User::traineeExists(login\&.toString()));}
.fi
.SS "int SH_User::id () const\fC [inline]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 54 du fichier SH_User\&.h\&.
.PP
Références SH_User::m_id\&.
.PP
Référencé par SH_User::setID()\&.
.PP
.nf
54 { return this->m_id; }
.fi
.SS "bool SH_User::isAdministrator () const\fC [inline]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 82 du fichier SH_User\&.h\&.
.PP
Références SH_User::m_administrator\&.
.PP
Référencé par SH_ApplicationCore::setMode(), et SH_User::SH_User()\&.
.PP
.nf
82 { return this->m_administrator; }
.fi
.SS "bool SH_User::isManagerX () const\fC [inline]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 68 du fichier SH_User\&.h\&.
.PP
Références SH_User::m_managerX\&.
.PP
Référencé par SH_ApplicationCore::setMode(), et SH_User::SH_User()\&.
.PP
.nf
68 { return this->m_managerX; }
.fi
.SS "bool SH_User::isManagerZ () const\fC [inline]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 75 du fichier SH_User\&.h\&.
.PP
Références SH_User::m_managerZ\&.
.PP
Référencé par SH_ApplicationCore::setMode(), et SH_User::SH_User()\&.
.PP
.nf
75 { return this->m_managerZ; }
.fi
.SS "bool SH_User::isReceptionist () const\fC [inherited]\fP"

.PP
Définition à la ligne 64 du fichier SH_User\&.cpp\&.
.PP
Références SH_User::m_receptionist\&.
.PP
Référencé par SH_ApplicationCore::setMode(), et SH_User::SH_User()\&.
.PP
.nf
65 {
66     return this->m_receptionist;
67 }
.fi
.SS "bool SH_User::isValid () const\fC [inherited]\fP"

.PP
Définition à la ligne 32 du fichier SH_User\&.cpp\&.
.PP
Références SH_User::m_id, et SH_User::m_name\&.
.PP
Référencé par SH_User::logIn(), SH_ApplicationCore::setUser(), et SH_ApplicationCore::userLogOut()\&.
.PP
.nf
32                             {
33     return ((!this->m_name\&.isEmpty()) && (this->m_id != 0));
34 }
.fi
.SS "\fBSH_User\fP * SH_User::logIn (QStringlogin, QStringpass)\fC [static]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 132 du fichier SH_User\&.cpp\&.
.PP
Références SH_DatabaseManager::execSelectQuery(), SH_DatabaseManager::getInstance(), SH_User::isValid(), SH_User::SH_User(), SH_User::traineeExists(), et SH_User::userExists()\&.
.PP
Référencé par SH_ApplicationCore::setUser()\&.
.PP
.nf
133 {
134     qDebug() << "log in";
135     bool isValid = false;
136     QCryptographicHash encPass(QCryptographicHash::Sha512);
137     encPass\&.addData(pass\&.toUtf8());
138     bool trainee=false;
139     QStringList fields;
140     QString table;
141     if(userExists(login)) {
142         fields << "ID" << "LOGIN" << "ISRECEPTIONIST" << "ISMANAGERX" << "ISMANAGERZ" << "ISADMINISTRATOR";
143         table ="USERS";
144     } else if(traineeExists(login)) {
145         fields << "ID" << "LOGIN";
146         table ="TRAINEES";
147         trainee=true;
148     }
149     QSqlQuery result = SH_DatabaseManager::getInstance()->execSelectQuery(table,fields,"LOGIN='"+login+"' AND ENCRYPTEDPASS='"+QString::fromLatin1(encPass\&.result()\&.toHex())\&.toUpper()+"'");
150     if(result\&.next()) {
151         QSqlRecord rec = result\&.record();
152         if(rec\&.isEmpty() || !result\&.isValid()) {
153             isValid = false;
154         } else {
155             isValid = (rec\&.value(rec\&.indexOf("LOGIN"))\&.toString() == login);
156         }
157 
158         if(isValid) {
159             if(trainee) {
160                 return new SH_Trainee(rec\&.value(rec\&.indexOf("LOGIN"))\&.toString(),rec\&.value(rec\&.indexOf("ID"))\&.toInt());
161             } else {
162                 return new SH_User(rec\&.value(rec\&.indexOf("LOGIN"))\&.toString(),rec\&.value(rec\&.indexOf("ID"))\&.toInt(),(rec\&.value(rec\&.indexOf("ISRECEPTIONIST"))\&.toString()=="1"),(rec\&.value(rec\&.indexOf("ISMANAGERX"))\&.toString()=="1"),(rec\&.value(rec\&.indexOf("ISMANAGERZ"))\&.toString()=="1"),(rec\&.value(rec\&.indexOf("ISADMINISTRATOR"))\&.toString()=="1"));
163             }
164         }
165     }
166     return new SH_User();
167 }
.fi
.SS "QString SH_User::name () const\fC [inherited]\fP"

.PP
Référencé par SH_User::setName()\&.
.SS "void SH_User::nameChanged ()\fC [signal]\fP, \fC [inherited]\fP"

.SS "int SH_User::roles () const\fC [inherited]\fP"

.SS "void SH_User::rolesChanged ()\fC [signal]\fP, \fC [inherited]\fP"

.SS "bool SH_User::traineeExists (QStringlogin)\fC [static]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 121 du fichier SH_User\&.cpp\&.
.PP
Références SH_DatabaseManager::getInstance()\&.
.PP
Référencé par SH_User::exists(), et SH_User::logIn()\&.
.PP
.nf
121                                          {
122     qDebug() << "trainee exists";
123     return (SH_DatabaseManager::getInstance()->dataCount("TRAINEES", "LOGIN='"+login+"'") == 1);
124 }
.fi
.SS "bool SH_User::userExists (QStringlogin)\fC [static]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 110 du fichier SH_User\&.cpp\&.
.PP
Références SH_DatabaseManager::getInstance()\&.
.PP
Référencé par SH_User::exists(), et SH_User::logIn()\&.
.PP
.nf
110                                       {
111     qDebug() << "user exists";
112     return (SH_DatabaseManager::getInstance()->dataCount("USERS", "LOGIN='"+login+"'") == 1);
113 }
.fi
.SS "void SH_User::validityChanged ()\fC [signal]\fP, \fC [inherited]\fP"

.SH "Documentation des propriétés"
.PP 
.SS "bool SH_User::administrator\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 23 du fichier SH_User\&.h\&.
.SS "int SH_User::id\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 18 du fichier SH_User\&.h\&.
.PP
Référencé par SH_ApplicationCore::launchBillThread()\&.
.SS "bool SH_User::managerX\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 21 du fichier SH_User\&.h\&.
.SS "bool SH_User::managerZ\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 22 du fichier SH_User\&.h\&.
.SS "QString SH_User::name\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 19 du fichier SH_User\&.h\&.
.PP
Référencé par SH_ApplicationCore::setMode(), et SH_ApplicationCore::setUser()\&.
.SS "bool SH_User::receptionist\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 20 du fichier SH_User\&.h\&.
.SS "int SH_User::roles\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 24 du fichier SH_User\&.h\&.
.SS "bool SH_User::valid\fC [read]\fP, \fC [inherited]\fP"

.PP
Définition à la ligne 25 du fichier SH_User\&.h\&.

.SH "Auteur"
.PP 
Généré automatiquement par Doxygen pour PreCheck à partir du code source\&.
