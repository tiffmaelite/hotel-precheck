SELECT genall_upsertID();

SELECT gen_upsert('ADDRESSES', 'client_id=CAST(NEW.client_ID AS INTEGER), zipcode=NEW.zipcode, phone=NEW.phone,complementaryline=NEW.complementaryline', 'contact=NEW.contact AND street=NEW.street AND number=NEW.number AND city=NEW.city AND country=NEW.country', 'ID');

SELECT gen_upsert('GROUPS', 'CONTACT_ID=CAST(NEW.CONTACT_ID AS INTEGER)', 'NAME=NEW.NAME', 'ID');

SELECT gen_upsert('BALANCELOG', 'balance=CAST(NEW.balance AS DECIMAL)', 'yearlog=CAST(NEW.yearlog AS SMALLINTEGER) AND monthlog=CAST(NEW.monthlog AS SMALLINTEGER) AND daylog=CAST(NEW.daylog AS SMALLINTEGER) AND hourlog=CAST(NEW.hourlog AS SMALLINTEGER)', 'BALANCE');

SELECT gen_upsert('NATIONALITIES', 'COUNTRY=NEW.COUNTRY, LONGISOCODE=NEW.LONGISOCODE, ISOCODE=NEW.ISOCODE', 'CODE=CAST(NEW.CODE AS SMALLINTEGER)', 'ID');

SELECT gen_upsertmult('CLIENTS', array['NAME=NEW.NAME, PHONE=NEW.PHONE, IDCARDSCAN=NEW.IDCARDSCAN, NATIONALITY_ID=CAST(NEW.NATIONALITY_ID AS INTEGER), HOMEADDRESS_ID=CAST(NEW.HOMEADDRESS_ID AS INTEGER), ISCURRENT=CAST(NEW.ISCURRENT AS BOOLEAN)','EMAIL=NEW.EMAIL, PHONE=NEW.PHONE, NATIONALITY_ID=CAST(NEW.NATIONALITY_ID AS INTEGER), HOMEADDRESS_ID=CAST(NEW.HOMEADDRESS_ID AS INTEGER),ISCURRENT=CAST(NEW.ISCURRENT AS BOOLEAN)', 'EMAIL=NEW.EMAIL, PHONE=NEW.PHONE, IDCARDSCAN=NEW.IDCARDSCAN, NATIONALITY_ID=CAST(NEW.NATIONALITY_ID AS INTEGER), ISCURRENT=CAST(NEW.ISCURRENT AS BOOLEAN)'], array['EMAIL=NEW.EMAIL','NAME=NEW.NAME AND IDCARDSCAN=NEW.IDCARDSCAN AND IDCARDSCAN IS NOT NULL','NAME=NEW.NAME AND HOMEADDRESS_ID=CAST(NEW.HOMEADDRESS_ID AS INTEGER) AND HOMEADDRESS_ID IS NOT NULL'], 'ID');

INSERT INTO NATIONALITIES --from http://www.lomag-man.org/iso3166paysmonde.xls
  (ID, COUNTRY, ISOCODE, LONGISOCODE, CODE)
  VALUES
(1, 'Afghanistan', 'AF', 'AFG', '004'),
(2, 'Albanie', 'AL', 'ALB', '008'),
(3, 'Algérie', 'DZ', 'DZA', '012'),
(4, 'Samoa orientales', 'AS', 'ASM', '016'),
(5, 'Andorre', 'AD', 'AND', '020'),
(6, 'Angola', 'AO', 'AGO', '024'),
(7, 'Anguilla', 'AI', 'AIA', '660'),
(8, 'Antarctique', 'AQ', 'ATA', '010'),
(9, 'Antigua-et-Barbuda', 'AG', 'ATG', '028'),
(10, 'Argentine', 'AR', 'ARG', '032'),
(11, 'Arménie', 'AM', 'ARM', '051'),
(12, 'Aruba', 'AW', 'ABW', '533'),
(13, 'Australie', 'AU', 'AUS', '036'),
(14, 'Autriche', 'AT', 'AUT', '040'),
(15, 'Azerbaïdjan', 'AZ', 'AZE', '031'),
(16, 'Bahamas', 'BS', 'BHS', '044'),
(17, 'Bahreïn', 'BH', 'BHR', '048'),
(18, 'Bangladesh', 'BD', 'BGD', '050'),
(19, 'Barbade', 'BB', 'BRB', '052'),
(20, 'Biélorussie', 'BY', 'BLR', '112'),
(21, 'Belgique', 'BE', 'BEL', '056'),
(22, 'Bélize', 'BZ', 'BLZ', '084'),
(23, 'Bénin', 'BJ', 'BEN', '204'),
(24, 'Bermudes', 'BM', 'BMU', '060'),
(25, 'Bhoutan', 'BT', 'BTN', '064'),
(26, 'Bolivie', 'BO', 'BOL', '068'),
(27, 'Bosnie-Herzégovine', 'BA', 'BIH', '070'),
(28, 'Botswana', 'BW', 'BWA', '072'),
(29, 'Bouvet (Île)', 'BV', 'BVT', '074'),
(30, 'Brésil', 'BR', 'BRA', '076'),
(31, 'Territoire britannique de l''Océan Indien', 'IO', 'IOT', '086'),
(32, 'Bruneï', 'BN', 'BRN', '096'),
(33, 'Bulgarie', 'BG', 'BGR', '100'),
(34, 'Burkina Faso', 'BF', 'BFA', '854'),
(35, 'Burundi', 'BI', 'BDI', '108'),
(36, 'Cambodge', 'KH', 'KHM', '116'),
(37, 'Cameroun', 'CM', 'CMR', '120'),
(38, 'Canada', 'CA', 'CAN', '124'),
(39, 'Cap Vert', 'CV', 'CPV', '132'),
(40, 'Caïmans (Îles)', 'KY', 'CYM', '136'),
(41, 'République Centrafricaine', 'CF', 'CAF', '140'),
(42, 'Tchad', 'TD', 'TCD', '148'),
(43, 'Chili', 'CL', 'CHL', '152'),
(44, 'Chine', 'CN', 'CHN', '156'),
(45, 'Christmas (Île)', 'CX', 'CXR', '162'),
(46, 'Cocos / Keeling (Îles)', 'CC', 'CCK', '166'),
(47, 'Colombie', 'CO', 'COL', '170'),
(48, 'Comores', 'KM', 'COM', '174'),
(49, 'Congo', 'CG', 'COG', '178'),
(50, 'République Démocratique du Congo', 'CD', 'COD', '180'),
(51, 'Cook (Îles)', 'CK', 'COK', '184'),
(52, 'Costa Rica', 'CR', 'CRI', '188'),
(53, 'Côte D''Ivoire', 'CI', 'CIV', '384'),
(54, 'Croatie', 'HR', 'HRV', '191'),
(55, 'Cuba', 'CU', 'CUB', '192'),
(56, 'Chypre', 'CY', 'CYP', '196'),
(57, 'République Tchèque', 'CZ', 'CZE', '203'),
(58, 'Danemark', 'DK', 'DNK', '208'),
(59, 'Djibouti', 'DJ', 'DJI', '262'),
(60, 'Dominique', 'DM', 'DMA', '212'),
(61, 'République Dominicaine', 'DO', 'DOM', '214'),
(62, 'Timor-Oriental', 'TP', 'TMP', '626'),
(63, 'Equateur', 'EC', 'ECU', '218'),
(64, 'Egypte', 'EG', 'EGY', '818'),
(65, 'Salvador', 'SV', 'SLV', '222'),
(66, 'Guinée Equatoriale', 'GQ', 'GNQ', '226'),
(67, 'Erythrée', 'ER', 'ERI', '232'),
(68, 'Estonie', 'EE', 'EST', '233'),
(69, 'Ethiopie', 'ET', 'ETH', '231'),
(70, 'Falkland / Malouines (Îles)', 'FK', 'FLK', '238'),
(71, 'Féroé (Îles)', 'FO', 'FRO', '234'),
(72, 'Fiji', 'FJ', 'FJI', '242'),
(73, 'Finlande', 'FI', 'FIN', '246'),
(74, 'France', 'FR', 'FRA', '250'),
(75, 'France métropolitaine', 'FX', 'FXX', '249'),
(76, 'Guyane française', 'GF', 'GUF', '254'),
(77, 'Polynésie française', 'PF', 'PYF', '258'),
(78, 'Territoires Antarctiques français', 'TF', 'ATF', '260'),
(79, 'Gabon', 'GA', 'GAB', '266'),
(80, 'Gambie', 'GM', 'GMB', '270'),
(81, 'Géorgie', 'GE', 'GEO', '268'),
(82, 'Allemagne', 'DE', 'DEU', '276'),
(83, 'Ghana', 'GH', 'GHA', '288'),
(84, 'Gibraltar', 'GI', 'GIB', '292'),
(85, 'Grèce', 'GR', 'GRC', '300'),
(86, 'Groënland', 'GL', 'GRL', '304'),
(87, 'Grenade', 'GD', 'GRD', '308'),
(88, 'Guadeloupe', 'GP', 'GLP', '312'),
(89, 'Guam', 'GU', 'GUM', '316'),
(90, 'Guatemala', 'GT', 'GTM', '320'),
(91, 'Guinée', 'GN', 'GIN', '324'),
(92, 'Guinée-Bissau', 'GW', 'GNB', '624'),
(93, 'Guyana', 'GY', 'GUY', '328'),
(94, 'Haïti', 'HT', 'HTI', '332'),
(95, 'Territoire des Îles Heard et McDonald', 'HM', 'HMD', '334'),
(96, 'Saint-Siège (Vatican)', 'VA', 'VAT', '336'),
(97, 'Honduras', 'HN', 'HND', '340'),
(98, 'Hong Kong', 'HK', 'HKG', '344'),
(99, 'Hongrie', 'HU', 'HUN', '348'),
(100, 'Islande', 'IS', 'ISL', '352'),
(101, 'Inde', 'IN', 'IND', '356'),
(102, 'Indonésie', 'ID', 'IDN', '360'),
(103, 'Iran (République islamique d'')', 'IR', 'IRN', '364'),
(104, 'Irak', 'IQ', 'IRQ', '368'),
(105, 'Irlande', 'IE', 'IRL', '372'),
(106, 'Israël', 'IL', 'ISR', '376'),
(107, 'Italie', 'IT', 'ITA', '380'),
(108, 'Jamaïque', 'JM', 'JAM', '388'),
(109, 'Japon', 'JP', 'JPN', '392'),
(110, 'Jordanie', 'JO', 'JOR', '400'),
(111, 'Kazakstan', 'KZ', 'KAZ', '398'),
(112, 'Kenya', 'KE', 'KEN', '404'),
(113, 'Kiribati', 'KI', 'KIR', '296'),
(114, 'Corée (République populaire démocratique de)', 'KP', 'PRK', '408'),
(115, 'Corée (République démocratique de)', 'KR', 'KOR', '410'),
(116, 'Koweït', 'KW', 'KWT', '414'),
(117, 'Kyrgyzstan', 'KG', 'KGZ', '417'),
(118, 'Laos (République populaire démocratique du)', 'LA', 'LAO', '418'),
(119, 'Lettonie', 'LV', 'LVA', '428'),
(120, 'Liban', 'LB', 'LBN', '422'),
(121, 'Lesotho', 'LS', 'LSO', '426'),
(122, 'Libéria', 'LR', 'LBR', '430'),
(123, 'Libye (Jamahiriya Arabe Libyenne)', 'LY', 'LBY', '434'),
(124, 'Liechtenstein', 'LI', 'LIE', '438'),
(125, 'Lithuanie', 'LT', 'LTU', '440'),
(126, 'Luxembourg', 'LU', 'LUX', '442'),
(127, 'Macau', 'MO', 'MAC', '446'),
(128, 'Macédoine (ancienne République yougoslave de)', 'MK', 'MKD', '807'),
(129, 'Madagascar', 'MG', 'MDG', '450'),
(130, 'Malawi', 'MW', 'MWI', '454'),
(131, 'Malaysie', 'MY', 'MYS', '458'),
(132, 'Maldives', 'MV', 'MDV', '462'),
(133, 'Mali', 'ML', 'MLI', '466'),
(134, 'Malte', 'MT', 'MLT', '470'),
(135, 'Marshall (Îles)', 'MH', 'MHL', '584'),
(136, 'Martinique', 'MQ', 'MTQ', '474'),
(137, 'Mauritanie', 'MR', 'MRT', '478'),
(138, 'Maurice', 'MU', 'MUS', '480'),
(139, 'Mayotte', 'YT', 'MYT', '175'),
(140, 'Mexique', 'MX', 'MEX', '484'),
(141, 'Micronésie (Etats fédérés de)', 'FM', 'FSM', '583'),
(142, 'Moldavie', 'MD', 'MDA', '498'),
(143, 'Monaco', 'MC', 'MCO', '492'),
(144, 'Mongolie', 'MN', 'MNG', '496'),
(145, 'Montserrat', 'MS', 'MSR', '500'),
(146, 'Maroc', 'MA', 'MAR', '504'),
(147, 'Mozambique', 'MZ', 'MOZ', '508'),
(148, 'Myanmar', 'MM', 'MMR', '104'),
(149, 'Namibie', 'NA', 'NAM', '516'),
(150, 'Nauru', 'NR', 'NRU', '520'),
(151, 'Népal', 'NP', 'NPL', '524'),
(152, 'Pays-Bas', 'NL', 'NLD', '528'),
(153, 'Antilles néerlandaises', 'AN', 'ANT', '530'),
(154, 'Nouvelle-Calédonie', 'NC', 'NCL', '540'),
(155, 'Nouvelle-Zélande', 'NZ', 'NZL', '554'),
(156, 'Nicaragua', 'NI', 'NIC', '558'),
(157, 'Niger', 'NE', 'NER', '562'),
(158, 'Nigéria', 'NG', 'NGA', '566'),
(159, 'Niue', 'NU', 'NIU', '570'),
(160, 'Norfolk (Île)', 'NF', 'NFK', '574'),
(161, 'Mariannes (Îles)', 'MP', 'MNP', '580'),
(162, 'Norvège', 'NO', 'NOR', '578'),
(163, 'Oman', 'OM', 'OMN', '512'),
(164, 'Pakistan', 'PK', 'PAK', '586'),
(165, 'Palau', 'PW', 'PLW', '585'),
(166, 'Panama', 'PA', 'PAN', '591'),
(167, 'Papouasie Nouvelle-Guinée', 'PG', 'PNG', '598'),
(168, 'Paraguay', 'PY', 'PRY', '600'),
(169, 'Pérou', 'PE', 'PER', '604'),
(170, 'Philippines', 'PH', 'PHL', '608'),
(171, 'Pitcaïrn', 'PN', 'PCN', '612'),
(172, 'Pologne', 'PL', 'POL', '616'),
(173, 'Portugal', 'PT', 'PRT', '620'),
(174, 'Porto Rico', 'PR', 'PRI', '630'),
(175, 'Quatar', 'QA', 'QAT', '634'),
(176, 'Réunion', 'RE', 'REU', '638'),
(177, 'Romania', 'RO', 'ROM', '642'),
(178, 'Russie (Fédération de)', 'RU', 'RUS', '643'),
(179, 'Rwanda', 'RW', 'RWA', '646'),
(180, 'Saint Kitts et Nevis', 'KN', 'KNA', '659'),
(181, 'Sainte Lucie', 'LC', 'LCA', '662'),
(182, 'Saint Vincent et Grenadines', 'VC', 'VCT', '670'),
(183, 'Samoa', 'WS', 'WSM', '882'),
(184, 'San Marin', 'SM', 'SMR', '674'),
(185, 'Sao Tomé et Principe', 'ST', 'STP', '678'),
(186, 'Arabie Saoudite', 'SA', 'SAU', '682'),
(187, 'Sénégal', 'SN', 'SEN', '686'),
(188, 'Seychelles', 'SC', 'SYC', '690'),
(189, 'Sierra Léone', 'SL', 'SLE', '694'),
(190, 'Singapour', 'SG', 'SGP', '702'),
(191, 'Slovaquie', 'SK', 'SVK', '703'),
(192, 'Slovénie', 'SI', 'SVN', '705'),
(193, 'Salomon (Îles)', 'SB', 'SLB', '090'),
(194, 'Somalie', 'SO', 'SOM', '706'),
(195, 'Afrique du Sud', 'ZA', 'ZAF', '710'),
(196, 'Géorgie du Sud et îles Sandwich du Sud', 'GS', 'SGS', '239'),
(197, 'Espagne', 'ES', 'ESP', '724'),
(198, 'Sri Lanka', 'LK', 'LKA', '144'),
(199, 'Ste Hélène', 'SH', 'SHN', '654'),
(200, 'St. Pierre et Miquelon', 'PM', 'SPM', '666'),
(201, 'Soudan', 'SD', 'SDN', '736'),
(202, 'Surinam', 'SR', 'SUR', '740'),
(203, 'Svalbard et Jan Mayen (Îles)', 'SJ', 'SJM', '744'),
(204, 'Swaziland', 'SZ', 'SWZ', '748'),
(205, 'Suède', 'SE', 'SWE', '752'),
(206, 'Suisse', 'CH', 'CHE', '756'),
(207, 'Syrie (République arabe syrienne)', 'SY', 'SYR', '760'),
(208, 'Taïwan', 'TW', 'TWN', '158'),
(209, 'Tadjikistan', 'TJ', 'TJK', '762'),
(210, 'Tanzanie', 'TZ', 'TZA', '834'),
(211, 'Thaïlande', 'TH', 'THA', '764'),
(212, 'Togo', 'TG', 'TGO', '768'),
(213, 'Tokelau', 'TK', 'TKL', '772'),
(214, 'Tonga', 'TO', 'TON', '776'),
(215, 'Trinidad et Tobago', 'TT', 'TTO', '780'),
(216, 'Tunisie', 'TN', 'TUN', '788'),
(217, 'Turquie', 'TR', 'TUR', '792'),
(218, 'Turkménistan', 'TM', 'TKM', '795'),
(219, 'Turks et Caicos (Îles)', 'TC', 'TCA', '796'),
(220, 'Tuvalu', 'TV', 'TUV', '798'),
(221, 'Ouganda', 'UG', 'UGA', '800'),
(222, 'Ukraine', 'UA', 'UKR', '804'),
(223, 'Emirats Arabes Unis', 'AE', 'ARE', '784'),
(224, 'Royaume-Uni', 'GB', 'GBR', '826'),
(225, 'Etats-Unis d''Amérique', 'US', 'USA', '840'),
(226, 'Territoires non incorporés des États-Unis', 'UM', 'UMI', '581'),
(227, 'Uruguay', 'UY', 'URY', '858'),
(228, 'Ouzbékistan', 'UZ', 'UZB', '860'),
(229, 'Vanuatu', 'VU', 'VUT', '548'),
(230, 'Vénézuela', 'VE', 'VEN', '862'),
(231, 'Vietnam', 'VN', 'VNM', '704'),
(232, 'Vierges du Royaume-Uni (Îles)', 'VG', 'VGB', '092'),
(233, 'Vierges des États-Unis (Îles)', 'VI', 'VIR', '850'),
(234, 'Wallis et Futuna (Îles)', 'WF', 'WLF', '876'),
(235, 'Sahara Occidental', 'EH', 'ESH', '732'),
(236, 'Yemen', 'YE', 'YEM', '887'),
(237, 'Yougoslavie', 'YU', 'YUG', '891'),
(238, 'Zambie', 'ZM', 'ZMB', '894'),
(239, 'Zimbabwe', 'ZW', 'ZWE', '716');
